{% load static %}

<div class="fr-card fr-card--horizontal fr-card--horizontal-tier">
    <div class="fr-card__body">
        <div class="fr-card__content">
            <h3 class="fr-card__title">
                API
            </h3>
            <div class="fr-card__desc">
                {% if api_key %}
                    <div class="fr-input-group">
                        <label class="fr-label" for="user-api-key">Votre token</label>
                        <input type="text" id="user-api-key" class="fr-input" value="{{ api_key }}" readonly />
                        <div class="fr-input-group__append">
                            <button type="button" id="user-api-key-copy-button" class="fr-btn fr-btn--sm">Copier</button>
                        </div>
                    </div>
                {% else %}
                    {% if user_kind == "BUYER" %}
                        <p>
                            Vous souhaitez entrer la liste de toutes les structures dans votre système d'information ?
                            Découvrez comment faire.
                        </p>
                    {% endif %}
                {% endif %}
            </div>
        </div>
        <div class="fr-card__footer">
            <ul class="fr-btns-group fr-btns-group--icon-right fr-btns-group--right fr-btns-group--inline">
                <li>
                    <a class="fr-btn fr-icon-arrow-right-s-line fr-btn--tertiary-no-outline" href="{% url 'api:home' %}">
                        Documentation
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="fr-card__header fr-hidden fr-unhidden-lg">
        <div class="fr-card__img">
            <img class="fr-responsive-img" src="{% static 'images/illustration-28.svg' %}" alt=""/>
        </div>
    </div>
</div>

{% block extra_js %}
<script type="text/javascript">
const copyToClipboard = str => {
    const el = document.getElementById('user-api-key');
    el.select();
    document.execCommand('copy');
};
document.addEventListener("DOMContentLoaded", function() {
    const apiKeyCopyButton = document.getElementById('user-api-key-copy-button');
    if (apiKeyCopyButton) {
        apiKeyCopyButton.addEventListener('click', function(e) {
            copyToClipboard();
        });
    }
});
</script>
{% endblock %}
