{% extends "layouts/base.html" %}
{% load bootstrap4 static humanize %}

{% block title %}{{ tender_kind_display }} {{ tender.title }}{{ block.super }}{% endblock %}

{% block breadcrumbs %}
<section>
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav class="c-breadcrumb c-breadcrumb--marche" aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{% url 'pages:home' %}">Accueil</a></li>
                        {% if user.is_authenticated %}
                            <li class="breadcrumb-item"><a href="{% url 'dashboard:home' %}">Tableau de bord</a></li>
                            <li class="breadcrumb-item"><a href="{% url 'tenders:list' %}">{{ parent_title }}</a></li>
                        {% endif %}
                        <li class="breadcrumb-item active" aria-current="page">{{ tender.title|truncatechars:25 }}</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block content %}
<section class="container">
    <div class="row">
        <div class="col-12 col-lg-8">
            {% if is_draft %}
                <div class="alert alert-warning fade show" role="status">
                    <div class="row">
                        <div class="col-auto pr-0">
                            <i class="ri-information-line ri-xl text-warning"></i>
                        </div>
                        <div class="col">
                            <p class="mb-0">Votre {{ tender_kind_display|default:tender.get_kind_display }} n'est pas encore publié.</p>
                        </div>
                    </div>
                </div>
            {% endif %}
            {% include "tenders/detail_card.html" with tender=tender %}
            {% if is_draft %}
                <section class="pb-4 float-right">
                    <a href="{% url 'tenders:update' tender.slug %}" class="btn btn-primary btn-ico">
                        <i class="ri-pencil-fill ri-lg font-weight-normal" aria-hidden="true"></i>
                        <span>Modifier</span>
                    </a>
                </section>
            {% endif %}
        </div>
        {% if tender.author != request.user and not tender.deadline_date_outdated %}
            <div class="col-12 col-lg-4">
                {% if siae_detail_display_count %}
                    <div class="alert alert-warning mt-3 mt-lg-0" role="alert">
                        <p class="mb-0 fs-sm">
                            Déjà {{ siae_detail_display_count }} prestataire{{ siae_detail_display_count|pluralize }} inclusif{{ siae_detail_display_count|pluralize }}
                            {{ siae_detail_display_count|pluralize:"a,ont" }} vu le besoin de ce client.
                        </p>
                    </div>
                {% endif %}

                {% if user_siae_has_detail_contact_click_date %}
                    <div class="alert alert-info mt-3 mt-lg-0" role="alert">
                        <p class="mb-1">
                            <i class="ri-information-line ri-lg"></i>
                            <strong>Conseil</strong>
                        </p>
                        <p class="mb-0 fs-sm">
                            N'attendez pas et contactez dès maintenant le client.
                            En fonction, envoyez lui un devis, une plaquette commerciale ou répondez à son marché.
                        </p>
                    </div>
                {% endif %}
            </div>
        {% endif %}
    </div>
</section>
{% endblock %}

{% block modals %}
{% include "auth/_login_or_signup_siae_tender_modal.html" %}
{% include "tenders/_detail_contact_click_confirm_modal.html" %}
{% endblock %}
