{% extends "tenders/create_base.html" %}
{% load static bootstrap4 %}

{% block step_title %}Aperçu du besoin{% endblock %}
{% block step_title_again %}Aperçu du besoin{% endblock %}
{% block step_subtitle %}C'est tout bon ! Vérifiez quand même que toutes les informations soient exactes.{% endblock %}

{% block recap_section %}
<section class="s-section">
    <div class="s-section__container container">
        <div class="s-section__row row">
            <div class="s-section__col col-12 col-lg-8">
                {% include "tenders/detail_card.html" with tender=tender source_form="true" %}
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block content_form %}
<div class="row mb-3 mb-lg-5">
    <div class="col-12 col-lg-8">
    <label class="fake-label fake-label-required">{{ form.is_marche_useful.label }}</label>
    {% bootstrap_field form.is_marche_useful show_label=False %}
    {% bootstrap_field form.marche_benefits %}
    </div>
    <div class="col-12 col-lg-4">
        <div class="alert alert-info mt-3 mt-lg-0" role="alert">
            <p class="mb-0">
                Ces éléments nous aident à mesurer l'utilité du Marché de l'inclusion.
            </p>
        </div>
    </div>
</div>
{% endblock %}

{% block submit_btn %}
<button type="submit" id="tender-create-form-submit-btn" class="btn btn-primary btn-ico float-right">
    <i class="ri-mail-send-line ri-lg"></i>
    <span>Publier et diffuser</span>
</button>
{% endblock submit_btn %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function () {
    let formPreviousButton = document.getElementById('tender-create-form-previous-step-btn');
    let formSubmitButton = document.getElementById('tender-create-form-submit-btn');

    function submitForm() {
        $(formPreviousButton).prop('disabled', true);
        $(formSubmitButton).prop('disabled', true);
        formSubmitButton.innerHTML += "&nbsp;<i class='ri-loader-4-line ri-spinner ri-lg'></i>";
        $('form').submit();
    }

    formSubmitButton.addEventListener('click', function(e) {
        submitForm();
    });
});
</script>
{% endblock %}
