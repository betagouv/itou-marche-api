{% extends "tenders/create_base.html" %}
{% load bootstrap4 static %}

{% block step_title %}Description du besoin{% endblock %}
{% block step_title_again %}Description du besoin{% endblock %}
{% block step_subtitle %}Veuillez détailler au maximum votre besoin pour que les prestataires inclusifs puissent se positionner.{% endblock %}

{% block content_form %}
{% csrf_token %}
<div class="row">
    <div class="col-12 col-lg-7">
        {% bootstrap_field form.description %}
    </div>
    <div class="col-12 col-lg-5">
        <div class="c-form-conseil">
            <div>
                <p>
                    <i class="ri-lightbulb-line ri-lg mr-1"></i><strong>Conseil</strong><br>
                    Décrivez en détail votre besoin pour permettre aux prestataires inclusifs de vous faire des réponses personnalisées.
                </p>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-12 col-lg-7">
        {% bootstrap_field form.start_working_date %}
    </div>
</div>
<div class="row">
    <div class="col-12 col-lg-7">
        {% bootstrap_field form.external_link %}
    </div>
</div>
<div class="row">
    <div class="col-12 col-lg-7">
        {% bootstrap_field form.constraints %}
    </div>
    <div class="col-12 col-lg-5">
        <div class="c-form-conseil">
            <div>
                <p>
                    <i class="ri-lightbulb-line ri-lg mr-1"></i><strong>Conseil</strong>
                    <br />
                    Les contraintes techniques spécifiques sont les exigences que vous souhaitez porter à la connaissance des prestataires inclusifs.
                </p>
                <p>
                    Plus elles seront précises, plus vous aurez de chances de recevoir des réponses qualitatives des prestataires inclusifs.
                </p>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-12 col-lg-7">
        {% bootstrap_field form.amount %}
        {% bootstrap_field form.why_amount_is_blank class="inline-block" show_label=False %}
        {% bootstrap_field form.accept_share_amount %}
    </div>
    <div class="col-12 col-lg-5">
        <div class="c-form-conseil">
            <div>
                <p>
                    <i class="ri-lightbulb-line ri-lg mr-1"></i><strong>Conseil</strong>
                    <br />
                    Le montant € estimé nous aide à évaluer l'impact de la plateforme du Marché de l'inclusion.
                </p>
                <p>
                    Cette donnée restera confidentielle si vous souhaitez ne pas la partager aux prestataires.
                </p>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-12 col-lg-7">
        <label class="fake-label">Co-traitance</label>
        {% bootstrap_field form.accept_cocontracting %}
    </div>
</div>
{% endblock content_form %}

{% block extra_js %}
<script>

function toggleRadioSelectElement(divToToggle, value) {
    if(value){
        divToToggle.classList.add("d-none");
        divToToggle.querySelectorAll('input[type=radio]').forEach(radio=> {
            radio.checked = false;
            radio.required = false;
        })
    } else {
        divToToggle.classList.remove("d-none");
        divToToggle.querySelectorAll('input[type=radio]').forEach(radio=> {
            radio.required = true;
        })
    }
}
document.addEventListener('DOMContentLoaded', function () {
    const selectDesciptionAmount = document.getElementById('id_description-amount');
    const divWhyIsBlank = document.getElementById('id_description-why_amount_is_blank');
    toggleRadioSelectElement(divWhyIsBlank, selectDesciptionAmount.value);

    selectDesciptionAmount.addEventListener("change", function() {
        toggleRadioSelectElement(divWhyIsBlank, this.value);
    });

});
</script>
{% endblock %}
