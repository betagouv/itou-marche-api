{% extends "tenders/create_base.html" %}
{% load dsfr_tags static %}

{% block step_title %}Contacts{% endblock %}
{% block step_subtitle %}Vous y Ãªtes presque ! Veuillez remplir les informations que nous partagerons aux prestataires inclusifs pour qu'elles puissent vous contacter.{% endblock %}

{% block content_form %}
{% csrf_token %}
<div class="fr-grid-row">
    <div class="fr-col-12 fr-col-lg-7">
        {% if not user.is_authenticated %}
            <div class="form-row">
                {% dsfr_form_field form.contact_first_name %}
                {% dsfr_form_field form.contact_last_name %}
            </div>
        {% endif %}
        {% dsfr_form_field form.contact_company_name %}
        {% if not user.is_authenticated %}
            <div class="form-row">
                {% dsfr_form_field form.contact_email %}
                {% dsfr_form_field form.contact_phone %}
            </div>
        {% endif %}
        {% dsfr_form_field form.response_kind %}
        {% dsfr_form_field form.response_is_anonymous %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script type="text/javascript">
    const checkboxResponseIsAnonymous = document.getElementById('id_contact-response_is_anonymous');
    const input_responses_kind = document.getElementById("id_contact-response_kind")

    const input_responses_kind_inputs = input_responses_kind.querySelectorAll("input")
    document.addEventListener("DOMContentLoaded", function() {
        // code
        if(checkboxResponseIsAnonymous.checked){
            input_responses_kind.parentElement.classList.remove("form-group-required")
            input_responses_kind_inputs.forEach(elmt => {
                elmt.checked = false;
                elmt.disabled = true;
            });
        } else {
            input_responses_kind.parentElement.classList.add("form-group-required")
        }
    });

    checkboxResponseIsAnonymous.addEventListener('change', e => {
        if(e.target.checked === true) {

            input_responses_kind_inputs.forEach(elmt => {
                elmt.checked = false;
                elmt.disabled = true;
            });
            input_responses_kind.parentElement.classList.remove("form-group-required")
        }
        if(e.target.checked === false) {
            input_responses_kind_inputs.forEach(elmt => {
                elmt.disabled = false;
            });
            input_responses_kind.parentElement.classList.add("form-group-required")
        }
    });
</script>

{% endblock %}
